<!doctype html>
<html lang="en">
<head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" crossorigin="anonymous"
            </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
            integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
            crossorigin="anonymous"></script>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="index.css">
    <title>Learn D3.js</title>
    <link rel="stylesheet" type="text/css" href="d3.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>

<div id="container"></div>

<svg class="line-chart"></svg>
<script type="text/javascript">
    console.log('script')
    var arr=[];
    var rem=[];
    var dirt = [];
    var teetime=[];
    function searchBandsInTown() {
console.log('fn')
        // Querying the bandsintown api for the selected artist, the ?app_id parameter is required, but can equal anything
        var queryURL = "https://wzy74zfyd3.execute-api.us-east-1.amazonaws.com/latest";
        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function(response) {


console.log('ffffff')
                for (var i=0; i<JSON.parse(response).Faces.length; i++){
// console.log(JSON.parse(response).Faces[i].ImageId);
                    arr.push(JSON.parse(response).Faces[i].ExternalImageId);


                }
                for (var j=0; j<arr.length; j++){
                    rem.push(arr[j].replace(/:/g, ""))};
                for (var o=0; o<rem.length; o++){
                    dirt.push(rem[o].replace(/PM/g, ""));
                }

                dirt.sort(function(a,b){ //Array now becomes [7, 8, 25, 41]
                    return a - b
                });
                console.log(dirt);
// console.log(arr);
                var counts = {};
                dirt.forEach(function(x) { counts[x] = (counts[x] || 0)+1; });
                console.log("People in each photo:");

                console.log(counts);
                teetime = Object.values(counts);
                console.log(teetime)

                var svg_width = 500,
                    svg_height = 250,
                    margin = {left:50, right: 20, top:30, bottom:30},
                    g_width = svg_width - margin.left - margin.right,
                    g_height = svg_height - margin.top - margin.bottom

                var data = teetime;

                var scale_x = d3.scale.linear().domain([0, data.length-1]).range([0, g_width]),
                    scale_y = d3.scale.linear().domain([0, d3.max(data)]).range([g_height, 0])

                var svg = d3.select("#container")
                    .append("svg:svg")
                    .attr("width", svg_width)
                    .attr("height", svg_height);

                var g = svg.append("svg:g")
                    .attr("width", g_width)
                    .attr("height", g_height)
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")") //transform = "translate(50, 30)"

                var area = d3.svg.area()
                    .x(function(d,i) { return scale_x(i); })
                    .y0(g_height)
                    .y1(function(d) { return scale_y(d); })
                    .interpolate("cardinal")

                g.append("svg:path")
                    .attr("d", area(data)) //d path data, line_generator- string, "M0,1L1,2L3,4"
                    .style("fill", "steelblue");

                var x_axis = d3.svg.axis().scale(scale_x).ticks(5)
                var y_axis = d3.svg.axis().scale(scale_y).orient("left").ticks(5)


                g.append("svg:g")
                    .call(x_axis)
                    .attr("transform", "translate(0," + g_height + ")")

                g.append("svg:g")
                    .call(y_axis)
                    .append("text")
                    .text("Price($)")
                    .attr("transform", "rotate(-90)")
                    .attr("text-anchor", "end")
                    .attr("dy", "1em")

        })}
    $( document ).ready(function() {
        searchBandsInTown();

    });

</script>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
</body>
</html>